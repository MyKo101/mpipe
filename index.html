<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Adds extra functionality to pipelines • mpipe</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Adds extra functionality to pipelines">
<meta property="og:description" content="Add extra functionality to allow users to avoid
    breaking out of a pipeline.">
<meta property="og:image" content="https://michaelbarrowman.co.uk/mpipe/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">mpipe</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9014</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/MyKo101/mpipe/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="mpipe-" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#mpipe-" class="anchor"></a>mpipe <img src="reference/figures/logo.png" align="right" height="139">
</h1></div>
<!-- badges: start -->

<!-- badges: end -->
<p>The <code>mpipe</code> package is designed to add to extra functionality to the “pipelining” of <code>tidyverse</code> style processes. When running a pipeline, it is common to break out of a pipeline to perform other actions, and then to commence a new pipeline. <code>mpipe</code> aims to permit a stronger use of pipelining, whilst reducing the need to break out. This piece of software is still under very active development and suggestions for improvements are welcome.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the development version of <code>mpipe</code> from <a href="https://github.com/MyKo101/mpipe">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="co"># install.packages("devtools")</span>
<span class="co"># devtools::install_github("MyKo101/mpipe")</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://michaelbarrowman.co.uk/mpipe">mpipe</a></span>)
</pre></div>
<p>The <code>mpipe</code> package is not currently available on CRAN.</p>
<div id="examples" class="section level3">
<h3 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h3>
<p>The <code>palmerpenguins</code> package provides data on three species of penguins (Gentoo, Adelie and Chinstrap) over three islands (Biscoe, Dream and Torgersen). We’ll use the length and depth of their bills. A lot of the examples in this page are rather convoluted (and for many, there are other easier ways to get the same results, but they’re here to demonstrate <code>mpipe</code> functionality)</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="kw">mutils</span>::<span class="fu"><a href="https://michaelbarrowman.co.uk/mutils/reference/load_unload.html">load_packages</a></span>(<span class="kw">dplyr</span>, <span class="kw">magrittr</span>, <span class="kw">palmerpenguins</span>, <span class="kw">mutils</span>, <span class="kw">ggplot2</span>)

<span class="kw">penguins</span> <span class="op">&lt;-</span> <span class="kw">palmerpenguins</span>::<span class="kw"><a href="https://allisonhorst.github.io/palmerpenguins/reference/penguins.html">penguins</a></span> <span class="op">%&gt;%</span> 
  <span class="fu">select</span>(<span class="op">-</span><span class="kw">body_mass_g</span>,<span class="op">-</span><span class="kw">flipper_length_mm</span>) <span class="op">%&gt;%</span>
  <span class="fu">filter_all</span>(<span class="op">~</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="kw">.</span>))
</pre></div>
</div>
</div>
<div id="fseq" class="section level2">
<h2 class="hasAnchor">
<a href="#fseq" class="anchor"></a>fseq</h2>
<p>A little used feature of the <code>magrittr</code> package’s <code><a href="reference/%&gt;%.html">%&gt;%</a></code> pipe is that is can be used to create functions. By using a <code>.</code> as the initial argument, the output will be a function and can be applied to other pieces of data. These kinds of functions are called <code>fseq</code> functions (short for functional sequences).</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="kw">summarise_my_data</span> <span class="op">&lt;-</span> <span class="kw">.</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span>(<span class="kw">species</span>,<span class="kw">island</span>,<span class="kw">sex</span>) <span class="op">%&gt;%</span>
  <span class="fu">summarise_all</span>(<span class="kw">mean</span>,.groups=<span class="st">"keep"</span>)
<span class="kw">summarise_my_data</span>
<span class="co">#&gt; Functional sequence with the following components:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  1. group_by(., species, island, sex)</span>
<span class="co">#&gt;  2. summarise_all(., mean, .groups = "keep")</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Use 'functions' to extract the individual functions.</span>

<span class="fu">summarise_my_data</span>(<span class="kw">penguins</span>)
<span class="co">#&gt; # A tibble: 10 x 5</span>
<span class="co">#&gt; # Groups:   species, island [5]</span>
<span class="co">#&gt;    species   island    sex    bill_length_mm bill_depth_mm</span>
<span class="co">#&gt;    &lt;fct&gt;     &lt;fct&gt;     &lt;fct&gt;           &lt;dbl&gt;         &lt;dbl&gt;</span>
<span class="co">#&gt;  1 Adelie    Biscoe    female           37.4          17.7</span>
<span class="co">#&gt;  2 Adelie    Biscoe    male             40.6          19.0</span>
<span class="co">#&gt;  3 Adelie    Dream     female           36.9          17.6</span>
<span class="co">#&gt;  4 Adelie    Dream     male             40.1          18.8</span>
<span class="co">#&gt;  5 Adelie    Torgersen female           37.6          17.6</span>
<span class="co">#&gt;  6 Adelie    Torgersen male             40.6          19.4</span>
<span class="co">#&gt;  7 Chinstrap Dream     female           46.6          17.6</span>
<span class="co">#&gt;  8 Chinstrap Dream     male             51.1          19.3</span>
<span class="co">#&gt;  9 Gentoo    Biscoe    female           45.6          14.2</span>
<span class="co">#&gt; 10 Gentoo    Biscoe    male             49.5          15.7</span>
</pre></div>
<p>The <code>mpipe</code> package includes a couple of extra things that can be done to these kinds of functions, including composition of <code>fseq</code> by adding them together. We’ll define another <code>fseq</code> to filter out some penguins and variables.</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="kw">filter_my_data</span> <span class="op">&lt;-</span> <span class="kw">.</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">bill_length_mm</span> <span class="op">&gt;</span> <span class="fl">43</span>) <span class="op">%&gt;%</span>
  <span class="fu">select</span>(<span class="kw">species</span>,<span class="kw">island</span>,<span class="kw">sex</span>,<span class="kw">bill_length_mm</span>)
<span class="kw">filter_my_data</span>
<span class="co">#&gt; Functional sequence with the following components:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  1. filter(., bill_length_mm &gt; 43)</span>
<span class="co">#&gt;  2. select(., species, island, sex, bill_length_mm)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Use 'functions' to extract the individual functions.</span>
</pre></div>
<p>Then we can create the composite functional sequence</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="kw">filter_my_data</span> <span class="op">+</span> <span class="kw">summarise_my_data</span>
<span class="co">#&gt; Functional sequence with the following components:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  1. filter(., bill_length_mm &gt; 43)</span>
<span class="co">#&gt;  2. select(., species, island, sex, bill_length_mm)</span>
<span class="co">#&gt;  3. group_by(., species, island, sex)</span>
<span class="co">#&gt;  4. summarise_all(., mean, .groups = "keep")</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Use 'functions' to extract the individual functions.</span>
</pre></div>
<p>We can either assign this to a new function name, or apply it to the data implicitly (using brackets)</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
(<span class="kw">filter_my_data</span> <span class="op">+</span> <span class="kw">summarise_my_data</span>)(<span class="kw">penguins</span>)
<span class="co">#&gt; # A tibble: 7 x 4</span>
<span class="co">#&gt; # Groups:   species, island [5]</span>
<span class="co">#&gt;   species   island    sex    bill_length_mm</span>
<span class="co">#&gt;   &lt;fct&gt;     &lt;fct&gt;     &lt;fct&gt;           &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Adelie    Biscoe    male             44.4</span>
<span class="co">#&gt; 2 Adelie    Dream     male             43.7</span>
<span class="co">#&gt; 3 Adelie    Torgersen male             44.8</span>
<span class="co">#&gt; 4 Chinstrap Dream     female           47.2</span>
<span class="co">#&gt; 5 Chinstrap Dream     male             51.1</span>
<span class="co">#&gt; 6 Gentoo    Biscoe    female           46.0</span>
<span class="co">#&gt; 7 Gentoo    Biscoe    male             49.5</span>
</pre></div>
<p>The <code>mpipe</code> package also includes a <code><a href="https://rdrr.io/r/base/length.html">length()</a></code> method for <code>fseq</code> which returns the number of elements in the functional sequence, as well as a pair of functions to check whether something is an <code>fseq</code>: <code><a href="reference/fseq_methods.html">is.fseq()</a></code> and <code><a href="reference/fseq_methods.html">is_fseq()</a></code> (depending on your own preference). More functions for using <code>fseq</code> to their full potential will be added in future releases.</p>
</div>
<div id="side-effects" class="section level2">
<h2 class="hasAnchor">
<a href="#side-effects" class="anchor"></a>Side Effects</h2>
<p>A large reason for breaking out of a pipeline is to do actions such as plotting or providing feedback to the user. the <code>mpipe</code> package provides two functions that are particularly useful for avoiding leaving a pipeline. The way this is done is that the functions side effects are activated, but the functions return an untouched version of the data it was originally provided. This is similar to using the <code><a href="reference/%&gt;%.html">%T&gt;%</a></code> pipe in magrittr, but can be done with the traditional <code><a href="reference/%&gt;%.html">%&gt;%</a></code> pipe and is explicit in the name of the function.</p>
<ul>
<li>
<code><a href="reference/pipe_qplot.html">pipe_qplot()</a></code> - allows the user to create <code>ggplot2</code> style plots using <code>qplot()</code> syntax (akin to the base R <code><a href="https://rdrr.io/r/graphics/plot.html">plot()</a></code> syntax). This is essentially a wrapper function that also permits saving and theming of the plots.</li>
<li>
<code><a href="reference/pipe_cat.html">pipe_cat()</a></code> - allows the user to output information to the console (or any other sink) in the much the same way that <code><a href="https://rdrr.io/r/base/cat.html">cat()</a></code> does. Any calls/functions will be evaluated appropriately for this output. Grouped tibbles will be parsed separately.</li>
</ul>
<p>Here we will create a plot of Bill length against Bill depth stratified by the three grouping variables: <code>species</code>, <code>sex</code> and <code>island.</code> We’ll colour-code <code>species</code> using <code>col = species</code>, and <code>facets = sex ~ island</code> will create facets based on these two variables. We will then focus on the Biscoe island penguins (using <code><a href="https://rdrr.io/r/stats/filter.html">filter()</a></code>), and output the average Bill length, then stratify it by sex and species. Finally, we will return a dataset that contains the mean of Bill length and depth across these groups.</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="kw">penguins</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="reference/pipe_qplot.html">pipe_qplot</a></span>(<span class="kw">bill_length_mm</span>, <span class="kw">bill_depth_mm</span>, col = <span class="kw">species</span>,
             xlab = <span class="st">"Bill Length (mm)"</span>, ylab = <span class="st">"Culmun Depth (mm)"</span>,
             theme = <span class="st">"light"</span>, facets = <span class="kw">sex</span> <span class="op">~</span> <span class="kw">island</span>) <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">island</span> <span class="op">==</span> <span class="st">"Biscoe"</span>) <span class="op">%&gt;%</span> 
  <span class="fu"><a href="reference/pipe_cat.html">pipe_cat</a></span>(<span class="st">"Biscoe Average Culmun Length (mm):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="kw">bill_length_mm</span>), <span class="st">"\n\n"</span>) <span class="op">%&gt;%</span>
  <span class="fu">group_by</span>(<span class="kw">species</span>,<span class="kw">sex</span>) <span class="op">%&gt;%</span>
  <span class="fu"><a href="reference/pipe_cat.html">pipe_cat</a></span>(<span class="kw">sex</span>, <span class="kw">species</span>, <span class="st">"Average Culmun Length (mm):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="kw">bill_length_mm</span>), <span class="st">"\n"</span>) <span class="op">%&gt;%</span>
  <span class="fu">summarise_if</span>(<span class="kw">is.numeric</span>, <span class="kw">mean</span>)
</pre></div>
<p><img src="reference/figures/README-side_effects_example-1.png" width="100%"></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co">#&gt; Biscoe Average Culmun Length (mm): 45.24847 </span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="co">#&gt; </span></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="co">#&gt; female Adelie Average Culmun Length (mm): 37.35909 </span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co">#&gt; male   Adelie Average Culmun Length (mm): 40.59091 </span></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="co">#&gt; female Gentoo Average Culmun Length (mm): 45.56379 </span></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="co">#&gt; male   Gentoo Average Culmun Length (mm): 49.47377</span></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="co">#&gt; # A tibble: 4 x 4</span></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="co">#&gt; # Groups:   species [2]</span></span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="co">#&gt;   species sex    bill_length_mm bill_depth_mm</span></span>
<span id="cb8-10"><a href="#cb8-10"></a><span class="co">#&gt;   &lt;fct&gt;   &lt;fct&gt;           &lt;dbl&gt;         &lt;dbl&gt;</span></span>
<span id="cb8-11"><a href="#cb8-11"></a><span class="co">#&gt; 1 Adelie  female           37.4          17.7</span></span>
<span id="cb8-12"><a href="#cb8-12"></a><span class="co">#&gt; 2 Adelie  male             40.6          19.0</span></span>
<span id="cb8-13"><a href="#cb8-13"></a><span class="co">#&gt; 3 Gentoo  female           45.6          14.2</span></span>
<span id="cb8-14"><a href="#cb8-14"></a><span class="co">#&gt; 4 Gentoo  male             49.5          15.7</span></span></code></pre></div>
</div>
<div id="control-flow" class="section level2">
<h2 class="hasAnchor">
<a href="#control-flow" class="anchor"></a>Control Flow</h2>
<p>One of the key aspects of programming is being able to manipulate which lines of code are ran and when. This manipulation is called “Control Flow” (i.e. you control the flow of the processes through your code). The two main methods of this are via branches and loops. Branches force our code to make a choice, where loops allow repetition of the same lines of code.</p>
<p>In traditional R (as in many other languages), Branching is performed using <code>if()</code> or <code><a href="https://rdrr.io/r/base/switch.html">switch()</a></code> statements, and can also be vectorised with functions such as <code>if_else()</code> and <code>case_when()</code>. Loops are implemented using the <code>for()</code>, <code>while()</code> and <code>repeat()</code> statements and can essentially be vectorised using the <code><a href="https://rdrr.io/r/base/apply.html">apply()</a></code> and <code>map()</code> families of functions.</p>
<p>the <code>mpipe</code> package allows us to integrate this kind of control flow into a pipe by supplying different paths for data to follow based on a predicate, case or condition. Branches are implemented via the <code><a href="reference/if_branch.html">if_branch()</a></code> and <code><a href="reference/switch_branch.html">switch_branch()</a></code> functions, and loops are implemented via the <code><a href="reference/while_pipe.html">while_pipe()</a></code> function.</p>
<div id="branches" class="section level3">
<h3 class="hasAnchor">
<a href="#branches" class="anchor"></a>Branches</h3>
<div id="if_branch" class="section level4">
<h4 class="hasAnchor">
<a href="#if_branch" class="anchor"></a>if_branch()</h4>
<p>The <code><a href="reference/if_branch.html">if_branch()</a></code> works similar to an <code>if</code> statement. The function chooses whether to data should proceed down the <code>fun</code> branch or the <code>elsefun</code> branch (if supplied) depending on how <code>predicate</code> is evaluated.</p>
<p>First, we’ll define an <code>fseq</code> style function, and apply it to the data twice. The <code>fseq</code> function will first shuffle the data and then if a male penguin ends up at the top of our list, we’ll pick just the Biscoe island penguins and extract the bill length summary statistics, if a female penguin ends up on top, we’ll pick out the Biscoe &amp; Dream island penguis and extract the bill depth summary statistics.</p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="kw">f</span> <span class="op">&lt;-</span> <span class="kw">.</span> <span class="op">%&gt;%</span>
  <span class="fu">sample_n</span>(<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">.</span>)) <span class="op">%&gt;%</span> <span class="co">#Shuffle the data</span>
  <span class="fu"><a href="reference/if_branch.html">if_branch</a></span>(<span class="kw">sex</span>[<span class="fl">1</span>] <span class="op">==</span> <span class="st">"MALE"</span>, <span class="co">#predicate: Is the top row a male penguin?</span>
            <span class="kw">.</span> <span class="op">%&gt;%</span> <span class="co">#TRUE path</span>
              <span class="fu"><a href="reference/pipe_cat.html">pipe_cat</a></span>(<span class="st">"Male penguin on top, extracting Bill Length for Biscoe penguins\n"</span>) <span class="op">%&gt;%</span>
              <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">island</span> <span class="op">==</span> <span class="st">"Biscoe"</span>) <span class="op">%&gt;%</span>
              <span class="fu">pull</span>(<span class="st">"bill_length_mm"</span>) <span class="op">%&gt;%</span>
              <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(), <span class="co"># End of TRUE Path</span>
            <span class="kw">.</span> <span class="op">%&gt;%</span> <span class="co">#FALSE path</span>
              <span class="fu"><a href="reference/pipe_cat.html">pipe_cat</a></span>(<span class="st">"Female penguin on top, extracting Bill Depth for Biscoe &amp; Dream penguins\n"</span>) <span class="op">%&gt;%</span>
              <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">island</span> != <span class="st">"Torgersen"</span>) <span class="op">%&gt;%</span>
              <span class="fu">pull</span>(<span class="st">"bill_length_mm"</span>) <span class="op">%&gt;%</span>
              <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>()) <span class="co"># End of FALSE Path &amp; end of if_branch()</span>
              
</pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">1</span>)
<span class="fu">f</span>(<span class="kw">penguins</span>)
<span class="co">#&gt; Female penguin on top, extracting Bill Depth for Biscoe &amp; Dream penguins</span>
<span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="co">#&gt;   32.10   40.52   45.55   44.81   49.20   59.60</span>
</pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">2</span>)
<span class="fu">f</span>(<span class="kw">penguins</span>)
<span class="co">#&gt; Female penguin on top, extracting Bill Depth for Biscoe &amp; Dream penguins</span>
<span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="co">#&gt;   32.10   40.52   45.55   44.81   49.20   59.60</span>
</pre></div>
</div>
<div id="switch_branch" class="section level4">
<h4 class="hasAnchor">
<a href="#switch_branch" class="anchor"></a>switch_branch()</h4>
<p>Similarly, the <code><a href="reference/switch_branch.html">switch_branch()</a></code> function allows us to expand on this by following a different path depending on the evaluation of <code>case</code>. The <code>case</code> argument will be evaluated in the context of <code>data</code> and shoudl return either a character value or a numeric value. Characters will be matched to the other arguments provided to the <code><a href="reference/switch_branch.html">switch_branch()</a></code> function and numerics will be matched by position.</p>
<p>This time, we will do similar to the previous example except checking which island ends up on top. We can see from the below (using the <code><a href="https://rdrr.io/r/base/table.html">table()</a></code> function overloaded by the <code>mutils</code> package), that if Torgersen is chosen as our random island, only Adelie penguins will be in our output.</p>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="kw">penguins</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="kw">species</span>,<span class="kw">island</span>)
<span class="co">#&gt;            island</span>
<span class="co">#&gt; species     Biscoe Dream Torgersen</span>
<span class="co">#&gt;   Adelie        44    55        47</span>
<span class="co">#&gt;   Chinstrap      0    68         0</span>
<span class="co">#&gt;   Gentoo       119     0         0</span>
</pre></div>
<p>This means we can drop this level and output only based on sex. <code><a href="reference/switch_branch.html">switch_branch()</a></code> will output the data untouched if <code>case</code> doesn’t match any of the other arguments supplied. So we will adapt our function for this:</p>
<div class="sourceCode" id="cb13"><pre class="downlit">
<span class="kw">f</span> <span class="op">&lt;-</span> <span class="kw">.</span> <span class="op">%&gt;%</span>
  <span class="fu">sample_n</span>(<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">.</span>)) <span class="op">%&gt;%</span>
  <span class="fu"><a href="reference/pipe_cat.html">pipe_cat</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="kw">island</span>[<span class="fl">1</span>]),<span class="st">"island is on top, so it will be chosen.\n"</span>) <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">island</span> <span class="op">==</span> <span class="kw">island</span>[<span class="fl">1</span>]) <span class="op">%&gt;%</span>
  <span class="fu">group_by</span>(<span class="kw">species</span>,<span class="kw">sex</span>) <span class="op">%&gt;%</span>
  <span class="fu"><a href="reference/switch_branch.html">switch_branch</a></span>(<span class="kw">.</span> <span class="op">%&gt;%</span> <span class="co"># What island ends up at the top row?</span>
                  <span class="fu">slice</span>(<span class="fl">1</span>) <span class="op">%&gt;%</span> <span class="co">#This time, we write case as an `fseq` as well.</span>
                  <span class="fu">pull</span>(<span class="st">"island"</span>) <span class="op">%&gt;%</span>
                  <span class="kw">as.character</span>,
                Torgersen = <span class="kw">.</span> <span class="op">%&gt;%</span>
                  <span class="kw">ungroup</span> <span class="op">%&gt;%</span> 
                  <span class="fu"><a href="reference/pipe_cat.html">pipe_cat</a></span>(<span class="st">"\t\tSpecies will be dropped.\n"</span>) <span class="op">%&gt;%</span>
                  <span class="fu">group_by</span>(<span class="kw">sex</span>) <span class="op">%&gt;%</span>
                  <span class="fu">select</span>(<span class="op">-</span><span class="kw">species</span>)) <span class="op">%&gt;%</span>
  <span class="fu">summarise_if</span>(<span class="kw">is.numeric</span>,<span class="kw">mean</span>)
</pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit">
<span class="co">## Force the "random" shuffle to put a "Biscoe" species is at the top</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">100</span>)
<span class="fu">f</span>(<span class="kw">penguins</span>)
<span class="co">#&gt; Biscoe island is on top, so it will be chosen.</span>
<span class="co">#&gt; # A tibble: 4 x 4</span>
<span class="co">#&gt; # Groups:   species [2]</span>
<span class="co">#&gt;   species sex    bill_length_mm bill_depth_mm</span>
<span class="co">#&gt;   &lt;fct&gt;   &lt;fct&gt;           &lt;dbl&gt;         &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Adelie  female           37.4          17.7</span>
<span class="co">#&gt; 2 Adelie  male             40.6          19.0</span>
<span class="co">#&gt; 3 Gentoo  female           45.6          14.2</span>
<span class="co">#&gt; 4 Gentoo  male             49.5          15.7</span>
</pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit">
<span class="co">## Force the "random" shuffle to put a "Torgersen" species is at the top</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">1000</span>)
<span class="fu">f</span>(<span class="kw">penguins</span>)
<span class="co">#&gt; Torgersen island is on top, so it will be chosen.</span>
<span class="co">#&gt;      Species will be dropped.</span>
<span class="co">#&gt; # A tibble: 2 x 3</span>
<span class="co">#&gt;   sex    bill_length_mm bill_depth_mm</span>
<span class="co">#&gt;   &lt;fct&gt;           &lt;dbl&gt;         &lt;dbl&gt;</span>
<span class="co">#&gt; 1 female           37.6          17.6</span>
<span class="co">#&gt; 2 male             40.6          19.4</span>
</pre></div>
</div>
</div>
<div id="loops" class="section level3">
<h3 class="hasAnchor">
<a href="#loops" class="anchor"></a>Loops</h3>
<p>In terms of loops, we introduce the <code><a href="reference/while_pipe.html">while_pipe()</a></code> function which acts similar to a <code>while()</code> loop, but within a pipeline. It will repeatedly apply the <code>fun</code> argument to the <code>data</code> until <code>cond</code> is not <code>TRUE</code>. <code>cond</code> will be evaluated within the context of <code>data</code> at each iteration.</p>
<p>For this example, we’re simply going to shuffle until the first penguin is a female and then output the top 5 results.</p>
<div class="sourceCode" id="cb16"><pre class="downlit">
<span class="kw">penguins</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="reference/while_pipe.html">while_pipe</a></span>(<span class="kw">sex</span>[<span class="fl">1</span>] != <span class="st">"female"</span>,
             <span class="kw">.</span> <span class="op">%&gt;%</span>
               <span class="fu">sample_n</span>(<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">.</span>))) <span class="op">%&gt;%</span>
  <span class="fu">slice</span>(<span class="fl">1</span><span class="op">:</span><span class="fl">5</span>)
<span class="co">#&gt; # A tibble: 5 x 5</span>
<span class="co">#&gt;   species   island bill_length_mm bill_depth_mm sex   </span>
<span class="co">#&gt;   &lt;fct&gt;     &lt;fct&gt;           &lt;dbl&gt;         &lt;dbl&gt; &lt;fct&gt; </span>
<span class="co">#&gt; 1 Adelie    Biscoe           35            17.9 female</span>
<span class="co">#&gt; 2 Adelie    Dream            40.9          18.9 male  </span>
<span class="co">#&gt; 3 Chinstrap Dream            51.3          19.9 male  </span>
<span class="co">#&gt; 4 Gentoo    Biscoe           50.5          15.9 male  </span>
<span class="co">#&gt; 5 Adelie    Biscoe           39            17.5 female</span>
</pre></div>
<p>The <code><a href="reference/while_pipe.html">while_pipe()</a></code> function also provides a <code>.counter</code> pronoun to keep track of how many times the loop as been run. This can be used within <code>cond</code> and within <code>fun</code> and even allows for simple leves of tidy evaluation.</p>
<div class="sourceCode" id="cb17"><pre class="downlit">
<span class="fu">tibble</span>(x = <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="fl">5</span>)) <span class="op">%&gt;%</span>
  <span class="fu"><a href="reference/while_pipe.html">while_pipe</a></span>(<span class="kw">.counter</span> <span class="op">&lt;=</span> <span class="fl">5</span>,
             <span class="kw">.</span> <span class="op">%&gt;%</span>
               <span class="fu">mutate</span>(<span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"x_"</span>,<span class="kw">.counter</span>) <span class="op">:=</span> <span class="kw">x</span> <span class="op">-</span> <span class="kw">x</span>[<span class="kw">.counter</span>]))
<span class="co">#&gt; # A tibble: 5 x 6</span>
<span class="co">#&gt;        x   x_1    x_2     x_3     x_4     x_5</span>
<span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1 0.0852 0     -0.578 -0.219  -0.151  -0.301 </span>
<span class="co">#&gt; 2 0.663  0.578  0      0.359   0.427   0.277 </span>
<span class="co">#&gt; 3 0.304  0.219 -0.359  0       0.0682 -0.0815</span>
<span class="co">#&gt; 4 0.236  0.151 -0.427 -0.0682  0      -0.150 </span>
<span class="co">#&gt; 5 0.386  0.301 -0.277  0.0815  0.150   0</span>
</pre></div>
</div>
</div>
<div id="code-of-conduct" class="section level2">
<h2 class="hasAnchor">
<a href="#code-of-conduct" class="anchor"></a>Code of Conduct</h2>
<p>Please note that the mpipe project is released with a <a href="https://michaelbarrowman.co.uk/mpipe/CODE_OF_CONDUCT.html">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<p><code>palmerpenguins</code></p>
<p>Gorman KB, Williams TD, Fraser WR (2014) Ecological Sexual Dimorphism and Environmental Variability within a Community of Antarctic Penguins (Genus Pygoscelis). PLoS ONE 9(3): e90081. <a href="https://doi.org/10.1371/journal.pone.0090081" class="uri">https://doi.org/10.1371/journal.pone.0090081</a></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/MyKo101/mpipe/">https://​github.com/​MyKo101/​mpipe/​</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="community">
<h2>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Michael Barrowman <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-0718-4482" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/MyKo101/mpipe/actions"><img src="https://github.com/MyKo101/mpipe/workflows/R-CMD-check/badge.svg" alt="R build status"></a></li>
<li><a href="https://codecov.io/gh/MyKo101/mpipe?branch=main"><img src="https://codecov.io/gh/MyKo101/mpipe/branch/main/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://github.com/MyKo101/mpipe"><img src="https://img.shields.io/badge/Version-0.0.0.9014-orange.svg" alt="Version Badge"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Michael Barrowman.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
